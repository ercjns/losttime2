(this["webpackJsonplosttime-orienteering"]=this["webpackJsonplosttime-orienteering"]||[]).push([[0],{86:function(e,t,n){},87:function(e,t,n){},98:function(e,t,n){"use strict";n.r(t);var r=n(0),s=n.n(r),i=n(34),o=n.n(i),a=n(36),c=(n(86),n(87),n(11)),l=n(109),d=n(79),u=n(9),h=n(10),j=n(14),p=n(13),b=n(110),f=n(112),m=n(104),O=n.p+"static/media/LostTimeWordmark.2977d17a.svg",x=n.p+"static/media/mapmontageblur.c977ea5b.jpg",g=n(1),v=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(g.jsxs)(b.a,{expand:"md",style:{backgroundImage:"url(".concat(x,")"),backgroundRepeat:"repeat-xy",marginBottom:"20px",maxWidth:"100%",width:"100%"},children:[Object(g.jsx)(b.a.Brand,{as:a.b,to:"/",style:{paddingLeft:"1rem"},children:Object(g.jsx)("img",{src:O,alt:"Lost Time Orienteering",style:{height:"60px",margin:"0px"}})}),Object(g.jsx)(b.a.Toggle,{"aria-controls":"basic-navbar-nav",style:{marginRight:"2rem"}}),Object(g.jsx)(b.a.Collapse,{id:"basic-navbar-nav",children:Object(g.jsx)(f.a,{children:Object(g.jsxs)(m.a,{title:"Admin",id:"basic-nav-dropdown",style:{marginLeft:"1rem"},children:[Object(g.jsx)(m.a.Item,{as:a.b,to:"/registrations",children:"Process Registrations"}),Object(g.jsx)(m.a.Item,{as:a.b,to:"/results",children:"Add Results"})]})})})]})}}]),n}(s.a.Component),y=n(26),C=n(19),S=n(29),E=n(70),R=n.n(E),w=n(105),k=n(106),L=n(107),N=n(108),P=n(28),F=n(111),T=n(80),I=n(77),D=n(2),M=n(81),_=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).onDrop=void 0,r.baseStyle={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:10,borderColor:"magenta",borderStyle:"dashed",backgroundColor:"lightgrey",color:"black",fontStyle:"italic",outline:"none",transition:"border .24s ease-in-out"},r.activeStyle={borderColor:"#2196f3"},r.acceptStyle={borderColor:"#00e676"},r.rejectStyle={borderColor:"#ff1744"},r.onDrop=function(e){console.log(e);for(var t=0;t<e.length;t++)r.props.parser(e[t]);r.setState({files:e})},r.state={files:[]},r}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return Object(g.jsx)(M.a,{onDrop:this.onDrop,children:function(t){var n=t.getRootProps,r=t.getInputProps;return Object(g.jsx)("section",{className:"container",children:Object(g.jsxs)("div",Object(D.a)(Object(D.a)({},n({className:"dropzone",style:e.baseStyle})),{},{children:[Object(g.jsx)("input",Object(D.a)({},r())),Object(g.jsx)("p",{children:e.props.helpText})]}))})}})}}]),n}(r.Component);function W(e){var t,n=[],r=Math.max.apply(Math,Object(C.a)(e.map((function(e){return e.StartNo?e.StartNo:0}))));t=r>1001?r+1:1001;var s,i=Object(y.a)(e);try{for(i.s();!(s=i.n()).done;){var o=s.value;o.GroupLeader&&(o.StartNo||(o.StartNo=t,t++),n.push(A(o)))}}catch(a){i.e(a)}finally{i.f()}return n}function A(e){if(!e.StartNo)throw new Error("Start number is required");return{Stno:e.StartNo,Chipno:e.Epunch.toString(),"Database Id":null,Surname:e.LastName,"First name":e.FirstName,S:e.Sex,nc:e.NonCompetitive?1:0,Classifier:0,City:e.Club,Short:e.ClassId,Rented:e.EpunchRented?"X":null,"Start fee":0,Paid:"X"}}var G=["OE0001","Stno","XStno","Chipno","Database Id","Surname","First name","YB","S","Block","nc","Start","Finish","Time","Classifier","Credit -","Penalty +","Comment","Club no.","Cl.name","City","Nat","Location","Region","Cl. no.","Short","Long","Entry cl. No","Entry class (short)","Entry class (long)","Rank","Ranking points","Num1","Num2","Num3","Text1","Text2","Text3","Addr. surname","Addr. first name","Street","Line2","Zip","Addr. city","Phone","Mobile","Fax","EMail","Rented","Start fee","Paid","Team","Course no.","Course","km","m","Course controls"],B=["OESco0001","Stno","XStno","Chipno","Database Id","Surname","First name","YB","S","Block","nc","Start","Finish","Time","Classifier","Credit -","Penalty +","Comment","Club no.","Cl.name","City","Nat","Location","Region","Cl. no.","Short","Long","Entry cl. No","Entry class (short)","Entry class (long)","Rank","Ranking points","Num1","Num2","Num3","Text1","Text2","Text3","Addr. surname","Addr. first name","Street","Line2","Zip","Addr. city","Phone","Mobile","Fax","EMail","Rented","Start fee","Paid","Team","Course no.","Course","km","m","Course controls"];function z(e){return 9===Object.keys(e).length&&"Bib"in e&&"SI Card"in e&&"Rental"in e&&"First Name"in e&&"Last Name"in e&&"Gender"in e&&"School Code"in e&&"Course"in e&&"NC"in e}function K(e){return"FirstName"in e&&"LastName"in e&&"Email"in e&&"Club"in e&&"Class"in e&&"Sex"in e&&"EPunch"in e&&"Phone"in e&&"EmergencyPhone"in e&&"CarLicense"in e&&"Newcomer"in e&&"Group"in e&&"Paid"in e&&"Owed"in e}var X=function(){function e(){Object(u.a)(this,e),this.StartNo=void 0,this.Epunch=void 0,this.EpunchRented=void 0,this.FirstName=void 0,this.LastName=void 0,this.Club=void 0,this.Course=void 0,this.ClassId=void 0,this.NonCompetitive=void 0,this.Sex=void 0,this.Phone=void 0,this.EmergencyPhone=void 0,this.CarLicense=void 0,this.Newcomer=void 0,this.Group=void 0,this.GroupLeader=void 0,this.Paid=void 0,this.Owed=void 0}return Object(h.a)(e,[{key:"fromWiolEntryCsv",value:function(e){return this.StartNo=e.Bib,this.Epunch=e["SI Card"],this.EpunchRented="X"===e.Rental,this.FirstName=e["First Name"],this.LastName=e["Last Name"],this.Club=e["School Code"],this.Course="",this.ClassId=e.Course,this.NonCompetitive="X"===e.NC,this.Sex=e.Gender,this.Phone="",this.EmergencyPhone="",this.CarLicense="",this.Newcomer="unknown",this.Group=1,this.GroupLeader=!0,this.Paid="unknown",this.Owed=0,this}},{key:"fromCascadeRegistrationCsv",value:function(e){return this.StartNo=null,this.Epunch=e.EPunch,this.EpunchRented=""===e.EPunch&&"*"!==e.Group,this.FirstName=e.FirstName,this.LastName=e.LastName,this.Club=e.Club,this.Course="",this.ClassId=e.Class,this.NonCompetitive=!1,this.Sex=e.Sex,this.Phone=e.Phone,this.EmergencyPhone=e.EmergencyPhone,this.CarLicense=e.CarLicense,this.Newcomer=e.Newcomer,this.Group=e.Group?"*"===e.Group?0:e.Group:1,this.GroupLeader="*"!==e.Group,this.Paid=e.Paid,this.Owed=e.Owed?e.Owed:0,this}}]),e}();var V=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(g.jsxs)("div",{children:[Object(g.jsx)("h2",{style:{},children:this.props.title}),Object(g.jsx)("div",{style:{width:"100%",height:"2px",backgroundColor:"magenta",marginTop:"10px",marginBottom:"10px"}})]})}}]),n}(s.a.Component),H=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:this.props.value.FirstName}),Object(g.jsx)("td",{children:this.props.value.LastName}),Object(g.jsx)("td",{children:this.props.value.Group>1?"Lead ("+this.props.value.Group+")":this.props.value.Group<1?"Member":""}),Object(g.jsx)("td",{children:this.props.value.Epunch}),Object(g.jsx)("td",{style:{textAlign:"center"},children:this.props.value.EpunchRented?"yes":"no"}),Object(g.jsx)("td",{children:this.props.value.ClassId}),Object(g.jsx)("td",{children:this.props.value.StartNo})]})}}]),n}(s.a.Component),J=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return this.props.failed>0?Object(g.jsxs)("li",{children:[this.props.name," (Found: ",this.props.success,", Failed: ",this.props.failed,")"]}):Object(g.jsxs)("li",{children:[this.props.name," (Found: ",this.props.success,")"]})}}]),n}(s.a.Component),U=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(){return Object(u.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){return Object(g.jsxs)(d.a,{xs:4,sm:3,md:4,lg:3,children:[Object(g.jsx)("b",{children:this.props.classname}),": ",this.props.regcount]})}}]),n}(s.a.Component),Y=n(65);function q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r={Roboto:{normal:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Regular.ttf",bold:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Medium.ttf",italics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-Italic.ttf",bolditalics:"https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.66/fonts/Roboto/Roboto-MediumItalic.ttf"}},s=[[" ","First","Last","Owed","Course","Epunch","Club","Phone",{text:"Emergency. Ph.",noWrap:!0},"Vehicle"]],i=[[" ","First","Last","Owed","Course","Epunch","Club","Phone",{text:"Emergency. Ph.",noWrap:!0},"Vehicle"]],o=[[" ","First","Last","Owed","Course","Epunch","Club","Phone",{text:"Emergency. Ph.",noWrap:!0},"Vehicle"]],a=e.filter((function(e){return!0===e.GroupLeader})),c=a.filter((function(e){return e.Epunch.length>0})).map($),l=a.filter((function(e){return 0===e.Epunch.length})).map($),d=a.filter((function(e){return 0===e.Epunch.length})).map($);function u(e,t){return e[2].text&&t[2].text?e[2].text.localeCompare(t[2].text):e[2].text?1:-1}function h(e){return{columns:[{width:"50%",text:e},{width:"50%",text:n}],bold:!0,fontSize:15,margin:[0,0,0,10]}}function j(e,n){return{columns:[{text:"Page "+e.toString()+" of "+n+". Created: "+x(),fontSize:8,margin:[50,0,0,0]},{text:"Source File(s): "+t,fontSize:8,margin:[0,0,50,0],alignment:"right"}]}}s.push.apply(s,Object(C.a)(c)),i.push.apply(i,Object(C.a)(l)),o.push.apply(o,Object(C.a)(d)),s.sort(u),i.sort(u),o.sort(u);var p=function(){return{text:[{text:"Registration Volunteers: ",italics:!0,bold:!0},"Check off each participant in the first column when they arrive. Please verify course assignment, epunch number, contact, and vehicle information. Collect any money owed and cross out in the owed column when paid."],margin:[0,0,0,10]}},b=function(){return{text:[{text:"Registration Volunteers: ",italics:!0,bold:!0},"Check off each participant in the first column when they arrive. Write the rental epunch number in the large box but do not check the shaded box. Please verify course assignment, contact, and vehicle information. Collect any money owed and cross out in the owed column when paid."],margin:[0,0,0,10]}},f=function(){return{text:[{text:"Finish Volunteers: ",italics:!0,bold:!0},"Find any epunch numbers that haven't been checked off. Find the corresponding registration in the computer, add the epunch number from this page, and check it off. Return this list to registration."],margin:[0,0,0,10]}},m=function(){return{fillColor:function(e){return e%2===1?"#EEEEEE":null},paddingLeft:function(){return 4},paddingRight:function(){return 4},paddingTop:function(){return 2},paddingBottom:function(){return 2},hLineWidth:function(e,t){return 0===e||e===t.table.body.length?0:e===t.table.headerRows?2:1},vLineWidth:function(){return 0},hLineColor:function(e){return 1===e?"black":"white"}}},O=function(){return{fillColor:function(e){return e%2===1?"#EEEEEE":null},paddingLeft:function(){return 4},paddingRight:function(){return 4},paddingTop:function(){return 6},paddingBottom:function(){return 4},hLineWidth:function(e,t){return 0===e||e===t.table.body.length?0:e===t.table.headerRows?2:0},vLineWidth:function(){return.5},hLineColor:function(e){return 1===e?"black":"white"},vLineColor:function(){return"white"}}};function x(){var e=new Date,t=e.getFullYear().toString(),n=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],r=e.getDate().toString().padStart(2,"0"),s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][e.getDay()],i=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0");return i.concat(":",o," ",s," ",r," ",n,", ",t)}var g={pageSize:"LETTER",pageOrientation:"landscape",footer:j,content:[h("Pre-Registration List: OWNED punches"),p(),{layout:O(),table:{headerRows:1,dontBreakRows:!0,body:s}}]},v={pageSize:"LETTER",pageOrientation:"landscape",footer:j,content:[h("Pre-Registration List: RENTAL punches (list A)"),b(),f(),{layout:m(),table:{headerRows:1,body:i}}]},y={pageSize:"LETTER",pageOrientation:"landscape",footer:j,content:[h("Pre-Registration List: RENTAL punches (list B)"),b(),f(),{layout:m(),table:{headerRows:1,body:o}}]};return[{name:"Owned",doc:Y.createPdf(g,{},r)},{name:"RentalA",doc:Y.createPdf(v,{},r)},{name:"RentalB",doc:Y.createPdf(y,{},r)}]}function $(e){return[{table:{widths:[12],heights:[10],body:[[{text:e.Owed>0?{text:"$".concat(e.Owed.toString()),color:"#999999",fontSize:7}:" ",border:[!0,!0,!0,!0]}]]}},{text:e.FirstName,fontSize:11},{text:e.LastName,fontSize:11},e.Owed>0?{text:"$".concat(e.Owed.toString()),fontSize:11,bold:!0}:"",{text:e.ClassId,fontSize:11},0===e.Epunch.length?{table:{widths:[100],heights:[25],body:[[{columns:[{width:"*",text:" "},{width:"auto",text:"     ",lineHeight:1.45,background:"#CCCCCC"}]}]]},layout:{hLineWidth:function(){return 1.5},vLineWidth:function(){return 1.5},hLineColor:function(){return"black"},vLineColor:function(){return"black"},paddingTop:function(){return 2},paddingBottom:function(){return-2},paddingRight:function(){return 2}}}:{text:e.Epunch,fontSize:11,alignment:"right"},{text:e.Club,fontSize:11},{text:Z(e.Phone),fontSize:11,noWrap:!0},{text:Z(e.EmergencyPhone),fontSize:11,noWrap:!0},{text:e.CarLicense,fontSize:8}]}function Z(e){var t=(""+e).replace(/\D/g,""),n=t.match(/^(1|)?(\d{3})(\d{3})(\d{4})$/);return n?["(",n[2],") ",n[3],"-",n[4]].join(""):t}var Q=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={filesprocessed:[],entries:[],nextstartno:1e3,pdftextvalue:""},r.downloadOeRegCsv=r.downloadOeRegCsv.bind(Object(S.a)(r)),r.updateEntries=r.updateEntries.bind(Object(S.a)(r)),r.handleClearEntries=r.handleClearEntries.bind(Object(S.a)(r)),r.nowtimestring=r.nowtimestring.bind(Object(S.a)(r)),r.downloadpdf=r.downloadpdf.bind(Object(S.a)(r)),r.onpdftextchange=r.onpdftextchange.bind(Object(S.a)(r)),r}return Object(h.a)(n,[{key:"handleClearEntries",value:function(){this.setState({entries:[],filesprocessed:[]})}},{key:"downloadOeRegCsv",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(0!==this.state.entries.length){var t=W(this.state.entries);this.setState({entries:this.state.entries});var n={quotes:!1,delimiter:";",header:!0,skipEmptyLines:"greedy",columns:e?B:G},r=R.a.unparse(t,n),s=this.nowtimestring(),i=document.createElement("a");i.href="data:text/csv;charset=utf-8,"+encodeURI(r),i.target="_blank",i.download="EntriesForOe-".concat(s,".csv"),i.click()}else console.log("No entries")}},{key:"nowtimestring",value:function(){var e=new Date,t=e.getFullYear().toString(),n=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getDate().toString().padStart(2,"0"),s=e.getHours().toString().padStart(2,"0"),i=e.getMinutes().toString().padStart(2,"0");return t.concat(n,r,"T",s,i)}},{key:"updateEntries",value:function(e){var t=this;R.a.parse(e,{header:!0,transform:function(e,t){return e.replace(/\0/g,"").trim()},complete:function(e,n){var r=function(e,t){var n,r=[],s=0,i=0,o=Object(y.a)(e);try{for(o.s();!(n=o.n()).done;){var a=n.value;if(z(a)){var c=(new X).fromWiolEntryCsv(a);r.push(c)}else if(K(a)){var l=(new X).fromCascadeRegistrationCsv(a);r.push(l)}else Object.keys(a).length<=1?(console.log(Object.keys(a)),console.log("empty row"),s+=1):(console.log(Object.keys(a)),console.log("failed to parse row"),i+=1)}}catch(d){o.e(d)}finally{o.f()}return{data:r,meta:{success:r.length,failed:i,empty:s,maxstartno:Math.max.apply(Math,Object(C.a)(r.map((function(e){return e.StartNo?e.StartNo:1001}))))}}}(e.data,t.state.nextstartno),s=t.state.entries.concat(r.data);t.setState({entries:s,nextstartno:r.meta.maxstartno});var i={name:n.name,success:r.meta.success,failed:r.meta.failed,empty:r.meta.empty};t.setState({filesprocessed:[].concat(Object(C.a)(t.state.filesprocessed),[i])})}})}},{key:"downloadpdf",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=q(this.state.entries,this.state.filesprocessed.map((function(e){return e.name})),t),r=this.nowtimestring(),s=Object(y.a)(n);try{for(s.s();!(e=s.n()).done;){var i=e.value,o="Registrations-".concat(r,"-",i.name,".pdf");i.doc.download(o)}}catch(a){s.e(a)}finally{s.f()}}},{key:"onpdftextchange",value:function(e){e.preventDefault(),this.setState({pdftextvalue:e.target.value})}},{key:"render",value:function(){var e=this,t=this.state.entries.length>0?this.state.entries.map((function(e){return Object(g.jsx)(H,{value:e})})):Object(g.jsx)("tr",{children:Object(g.jsx)("td",{colSpan:6,style:{textAlign:"center"},children:"No Registrations to Show"})}),n=this.state.filesprocessed.map((function(e){return Object(g.jsx)(J,{name:e.name,success:e.success,failed:e.failed,empty:e.empty})})),r=this.state.entries.reduce((function(e,t){return t.GroupLeader?(e[t.ClassId]?e[t.ClassId]++:e[t.ClassId]=1,e):e}),{}),s=Object.entries(r).sort((function(e,t){return e[0].toLocaleLowerCase().localeCompare(t[0].toLocaleLowerCase())})).map((function(e){return Object(g.jsx)(U,{classname:e[0],regcount:e[1]})}));return Object(g.jsxs)("div",{children:[Object(g.jsx)(V,{title:"Pre-Process Registration Files"}),Object(g.jsx)("p",{children:"Save event registration information in .csv format. Upload multiple files to combine registration information from multiple sources. (Todo: click to expand for supported csv formats)"}),Object(g.jsx)("p",{children:"This tool creates outputs ready for import into SportSoftware (OE) and PDF files to print and use at check-in."}),Object(g.jsx)("h4",{children:"Files"}),Object(g.jsx)("p",{children:Object(g.jsx)(_,{parser:this.updateEntries,helpText:"Drop csv file(s) here or click to open file browser."})}),Object(g.jsxs)(w.a,{children:[Object(g.jsxs)(d.a,{xs:12,md:6,children:[Object(g.jsxs)(w.a,{children:[Object(g.jsxs)("p",{children:["Files Uploaded: ",this.state.filesprocessed.length]}),Object(g.jsx)("p",{children:Object(g.jsx)("ul",{children:n})}),Object(g.jsxs)("p",{children:["Registrations by Class (Total: ",this.state.entries.filter((function(e){return!0===e.GroupLeader})).length,") ",Object(g.jsx)("i",{children:"This total does not include group members"}),"."]}),Object(g.jsx)("p",{children:Object(g.jsx)(w.a,{children:s})})]}),Object(g.jsx)(w.a,{children:Object(g.jsxs)(k.a,{children:[Object(g.jsx)(L.a,{className:"me-2",children:Object(g.jsxs)(N.a,{title:"Download OE File",variant:"primary",disabled:!(this.state.entries.length>0),children:[Object(g.jsx)(P.a.Item,{onClick:function(){return e.downloadOeRegCsv()},children:"Regular"}),Object(g.jsx)(P.a.Item,{onClick:function(){return e.downloadOeRegCsv(!0)},children:"Score O"})]})}),Object(g.jsx)(L.a,{className:"me-2",children:Object(g.jsxs)(P.a,{children:[Object(g.jsx)(P.a.Toggle,{className:this.state.entries.length>0?"":"disabled",children:"Download Check-In PDFs"}),Object(g.jsxs)(P.a.Menu,{style:{minWidth:"20rem"},children:[Object(g.jsx)(P.a.ItemText,{children:"Additional Custom Header Text:"}),Object(g.jsx)(w.a,{className:"justify-content-center",children:Object(g.jsx)(d.a,{xs:12,children:Object(g.jsxs)(F.a,{style:{marginRight:"16px",marginLeft:"16px"},onSubmit:function(t){t.preventDefault(),e.downloadpdf(e.state.pdftextvalue)},children:[Object(g.jsx)(T.a,{type:"text",onChange:this.onpdftextchange,value:this.state.pdftextvalue}),Object(g.jsx)(I.a,{style:{marginTop:"8px"},type:"submit",disabled:!(this.state.entries.length>0),children:"Download PDFs"})]})})})]})]})}),Object(g.jsx)(L.a,{children:Object(g.jsx)(I.a,{variant:"outline-secondary",onClick:this.handleClearEntries,children:"Clear Registrations"})})]})})]}),Object(g.jsx)(d.a,{xs:6,md:6,children:Object(g.jsxs)("table",{style:{textAlign:"left"},children:[Object(g.jsx)("thead",{children:Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{children:"First"}),Object(g.jsx)("th",{children:"Last"}),Object(g.jsx)("th",{children:"Group"}),Object(g.jsx)("th",{children:"Chip"}),Object(g.jsx)("th",{children:"Rented?"}),Object(g.jsx)("th",{children:"Class"}),Object(g.jsx)("th",{children:"Start #"})]})}),Object(g.jsx)("tbody",{children:t})]})})]})]})}}]),n}(s.a.Component),ee=n(7),te=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={error:null,isLoaded:!1,races:[]},r}return Object(h.a)(n,[{key:"getRaceClasses",value:function(){var e=this;fetch("/api/events/"+this.props.event.id+"/classes").then((function(e){return e.json()})).then((function(t){e.setState({races:t,isLoaded:!0})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"componentDidMount",value:function(){this.getRaceClasses()}},{key:"formatTimeString",value:function(e){var t="";return"MissingPunch"===e.result.finish_status?t+=" msp":"DidNotFinish"===e.result.finish_status?t+=" dnf":"NotCompeting"===e.result.finish_status?t+=" nc":"OverTime"===e.result.finish_status?t+=" ovt":"Disqualified"===e.result.finish_status&&(t+=" DQ"),t+=" "+this.formatTimeMMMSS(e.time)}},{key:"formatTimeMMMSS",value:function(e){if(!e)return"--:--";var t=Math.floor(e/60).toString(),n=(e%60).toString().padStart(2,"0");return"".concat(t,":").concat(n)}},{key:"compareResults",value:function(e,t){return e.entry.competitive&&t.entry.competitive?"OK"===e.result.finish_status&&"OK"===t.result.finish_status?e.time&&t.time?e.time<t.time?-1:e.time>t.time?1:0:e.time?-1:t.time?1:0:"OK"===e.result.finish_status?-1:"OK"===t.result.finish_status?1:0:e.entry.competitive?-1:t.entry.competitive?1:0}},{key:"compareResultsByScore",value:function(e,t){return e.score&&t.score?t.score-e.score:e.score?-1:t.score?1:0}},{key:"compareTeamResults",value:function(e,t){return e.score!==t.score?t.score-e.score:0}},{key:"combineResultsForEventClasses",value:function(e){return e.reduce((function(e,t){if(e.some((function(e){return e.eventclass_id===t.eventclass_id}))){var n,r=e.findIndex((function(e){return e.eventclass_id===t.eventclass_id}));(n=e[r].raceresults).push.apply(n,Object(C.a)(t.raceresults))}else e.push(t);return e}),[])}},{key:"buildTeams",value:function(e){var t=this,n=e.reduce((function(e,t){return e[t.entry.club]||(e[t.entry.club]=[]),e[t.entry.club].push(t),e}),{}),r=[];return Object.entries(n).forEach((function(e){var n=Object(ee.a)(e,2),s=n[0],i=n[1].sort(t.compareResultsByScore).slice(0,3);r.push({club:s,score:i.reduce((function(e,t){return void 0===t.score?e:e+t.score}),0),results:i})})),r}},{key:"assignIndvScores",value:function(e){var t=this;return e.filter((function(e){return"OK"===e.result.finish_status&&e.entry.competitive})).sort(this.compareResults).map((function(e,n,r){if("OK"!==e.result.finish_status)e.pos=void 0;else if(0===n||0!==t.compareResults(e,r[n-1]))e.pos=n+1;else for(var s=n-1;s>=0;s--){if(0===s){e.pos=s+1;break}if(0!==t.compareResults(e,r[s])){e.pos=s+1+1;break}}return void 0===e.pos?e.score=void 0:1===e.pos?e.score=100:2===e.pos?e.score=95:3===e.pos?e.score=92:e.score=94-e.pos,e})),e.filter((function(e){return"MissingPunch"===e.result.finish_status||"DidNotFinish"===e.result.finish_status})).map((function(e){return e.score=0,e})),e}},{key:"render",value:function(){var e=this,t=this.state,n=t.error,r=t.isLoaded,i=t.races;i.filter((function(e){return"RaceScoring"===e.event_scoring})).forEach((function(t){t.raceresults=e.assignIndvScores(t.raceresults)}));var o=i.filter((function(e){return"RaceScoring"===e.event_scoring})).map((function(t){return Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:t.name}),Object(g.jsxs)("table",{children:[Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{children:"Pos."}),Object(g.jsx)("th",{children:"Name"}),Object(g.jsx)("th",{children:"Club"}),Object(g.jsx)("th",{children:"Time"}),Object(g.jsx)("th",{children:"Score"})]}),t.raceresults.map((function(n){var r,s,i;return"WorldCup"===t.race_scoring?Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:null===(r=n.pos)||void 0===r?void 0:r.toString()}),Object(g.jsx)("td",{children:n.entry.person}),Object(g.jsx)("td",{children:n.entry.club}),Object(g.jsx)("td",{style:{textAlign:"right"},children:e.formatTimeString(n)}),Object(g.jsx)("td",{style:{textAlign:"right"},children:null===(s=n.score)||void 0===s?void 0:s.toString()})]}):Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:null===(i=n.pos)||void 0===i?void 0:i.toString()}),Object(g.jsx)("td",{children:n.entry.person}),Object(g.jsx)("td",{children:n.entry.club}),Object(g.jsx)("td",{style:{textAlign:"right"},children:e.formatTimeString(n)}),Object(g.jsx)("td",{})]})}))]})]})}));i.filter((function(e){return"WIOLTeams"===e.event_scoring})).forEach((function(t){t.raceresults=e.assignIndvScores(t.raceresults).filter((function(e){return void 0!==e.score}))}));var a=this.combineResultsForEventClasses(i.filter((function(e){return"WIOLTeams"===e.event_scoring})));a.forEach((function(t){t.teamresults=e.buildTeams(t.raceresults).sort(e.compareTeamResults)}));var c=a.map((function(e){var t;return Object(g.jsxs)("div",{children:[Object(g.jsx)("h3",{children:e.name}),Object(g.jsxs)("table",{children:[Object(g.jsxs)("tr",{children:[Object(g.jsx)("th",{children:"Pos."}),Object(g.jsx)("th",{children:"Name"}),Object(g.jsx)("th",{children:"Club"}),Object(g.jsx)("th",{children:"Score"})]}),null===(t=e.teamresults)||void 0===t?void 0:t.map((function(e){return Object(g.jsxs)(s.a.Fragment,{children:[Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{}),Object(g.jsx)("td",{children:e.club}),Object(g.jsx)("td",{children:e.club}),Object(g.jsx)("td",{children:e.score})]}),e.results.map((function(e){return Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{}),Object(g.jsx)("td",{children:e.entry.person}),Object(g.jsx)("td",{children:e.entry.club}),Object(g.jsx)("td",{children:e.score})]})}))]})}))]})]})}));return n?Object(g.jsxs)("div",{children:["Error: ",n.message]}):r?Object(g.jsxs)("div",{children:[Object(g.jsxs)("ul",{children:[Object(g.jsxs)("li",{children:["Event Name: ",this.props.event.name]}),Object(g.jsxs)("li",{children:["Event Key: ",this.props.event.api_key]})]}),Object(g.jsx)("p",{children:"Classes"}),o,c]}):Object(g.jsx)("div",{children:"Loading..."})}}]),n}(s.a.Component),ne=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).loadNewResults=function(e){console.log(e.name),r.setState({isProcessing:!0});var t=new FormData;t.append("file",e),fetch("/api/race",{method:"POST",body:t}).then((function(e){return e.json()})).then((function(e){console.log(e),r.setState({event:e.event,isProcessing:!1})}))},r.state={event:null,isProcessing:!1},r}return Object(h.a)(n,[{key:"render",value:function(){return null!==this.state.event||this.state.isProcessing?null!==this.state.event?Object(g.jsxs)("div",{children:[Object(g.jsx)(V,{title:"Process Results Files"}),Object(g.jsx)("div",{children:Object(g.jsx)(te,{event:this.state.event})})]}):Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"Processing..."}),Object(g.jsx)("p",{children:"Please be patient, this can take a minute or two."})]}):Object(g.jsxs)("div",{children:[Object(g.jsx)(V,{title:"Process Results Files"}),Object(g.jsx)("p",{children:"Save event results using the IOF XML v3 format. Upload here, then follow the prompts to set scoring methods."}),Object(g.jsxs)("div",{children:[Object(g.jsx)("h4",{children:"Files"}),Object(g.jsx)("p",{children:Object(g.jsx)(_,{parser:this.loadNewResults,helpText:"Drop xml file here or click to open file browser."})})]})]})}}]),n}(s.a.Component),re=function(e){Object(j.a)(n,e);var t=Object(p.a)(n);function n(e){var r;return Object(u.a)(this,n),(r=t.call(this,e)).state={error:null,isLoaded:!1,events:[]},r}return Object(h.a)(n,[{key:"getEvents",value:function(){var e=this;fetch("/api/events").then((function(e){return e.json()})).then((function(t){e.setState({events:t,isLoaded:!0})}),(function(t){e.setState({isLoaded:!0,error:t})}))}},{key:"componentDidMount",value:function(){this.getEvents()}},{key:"render",value:function(){var e=this.state,t=e.error,n=e.isLoaded;return t?Object(g.jsxs)("div",{children:["Error: ",t.message]}):n?Object(g.jsxs)("div",{children:[Object(g.jsx)(V,{title:"Lost Time Orienteering"}),Object(g.jsxs)("p",{children:[Object(g.jsx)(I.a,{href:"/registrations",children:"Process Registrations"}),Object(g.jsx)(I.a,{href:"/results",children:"Process Results"})]})]}):Object(g.jsx)("div",{children:"Loading..."})}}]),n}(s.a.Component);var se=function(){return Object(g.jsx)("div",{className:"App",children:Object(g.jsxs)(l.a,{fluid:!0,style:{backgroundColor:"#F7F7F7",paddingLeft:0,paddingRight:0,minHeight:"100vh"},children:[Object(g.jsx)(v,{}),Object(g.jsx)(d.a,{xs:{span:10,offset:1},children:Object(g.jsxs)(c.c,{children:[Object(g.jsx)(c.a,{exact:!0,path:"/",children:Object(g.jsx)(re,{})}),Object(g.jsx)(c.a,{path:"/registrations",children:Object(g.jsx)(Q,{})}),Object(g.jsx)(c.a,{path:"/results",children:Object(g.jsx)(ne,{})})]})})]})})},ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,113)).then((function(t){var n=t.getCLS,r=t.getFID,s=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),s(e),i(e),o(e)}))};n(97);o.a.render(Object(g.jsx)(s.a.StrictMode,{children:Object(g.jsx)(a.a,{children:Object(g.jsx)(se,{})})}),document.getElementById("root")),ie()}},[[98,1,2]]]);
//# sourceMappingURL=main.54f2f28c.chunk.js.map