(this.webpackJsonpentryman=this.webpackJsonpentryman||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var s=n(1),i=n.n(s),r=n(20),a=n.n(r),o=(n(27),n(13)),c=n(4),l=n(5),h=n(11),d=n(7),u=n(6),j=(n(28),n(18)),p=n.n(j),b=n(3),m=n(22),O=n(0),f=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).onDrop=void 0,s.baseStyle={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:10,borderColor:"magenta",borderStyle:"dashed",backgroundColor:"lightgrey",color:"black",fontStyle:"italic",outline:"none",transition:"border .24s ease-in-out"},s.activeStyle={borderColor:"#2196f3"},s.acceptStyle={borderColor:"#00e676"},s.rejectStyle={borderColor:"#ff1744"},s.onDrop=function(e){console.log(e);for(var t=0;t<e.length;t++)s.props.parser(e[t]);s.setState({files:e})},s.state={files:[]},s}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(O.jsx)(m.a,{onDrop:this.onDrop,children:function(t){var n=t.getRootProps,s=t.getInputProps;return Object(O.jsx)("section",{className:"container",children:Object(O.jsxs)("div",Object(b.a)(Object(b.a)({},n({className:"dropzone",style:e.baseStyle})),{},{children:[Object(O.jsx)("input",Object(b.a)({},s())),Object(O.jsx)("p",{children:"Drop csv file(s) here or click to open file browser."})]}))})}})}}]),n}(s.Component),x=n(15);function v(e){if(!e.StartNo)throw"Start number is required";return{Stno:e.StartNo,Chipno:e.Epunch.toString(),"Database Id":null,Surname:e.LastName,"First name":e.FirstName,S:e.Sex,nc:e.NonCompetitive?1:0,Classifier:0,City:e.Club,Short:e.ClassId,Rented:e.EpunchRented?"X":null,"Start fee":0,Paid:"X"}}var g=["OE0001","Stno","XStno","Chipno","Database Id","Surname","First name","YB","S","Block","nc","Start","Finish","Time","Classifier","Credit -","Penalty +","Comment","Club no.","Cl.name","City","Nat","Location","Region","Cl. no.","Short","Long","Entry cl. No","Entry class (short)","Entry class (long)","Rank","Ranking points","Num1","Num2","Num3","Text1","Text2","Text3","Addr. surname","Addr. first name","Street","Line2","Zip","Addr. city","Phone","Mobile","Fax","EMail","Rented","Start fee","Paid","Team","Course no.","Course","km","m","Course controls"],C=n(34),y=n(35),S=n(37),N=n(36);function k(e){return 9===Object.keys(e).length&&"Bib #"in e&&"SI Card"in e&&"Rent"in e&&"First Name"in e&&"Last Name"in e&&"Gen"in e&&"School"in e&&"Course"in e&&"NC"in e}function E(e){return 14===Object.keys(e).length&&"FirstName"in e&&"LastName"in e&&"Email"in e&&"Club"in e&&"Class"in e&&"Sex"in e&&"EPunch"in e&&"Phone"in e&&"EmergencyPhone"in e&&"CarLicense"in e&&"Newcomer"in e&&"Group"in e&&"Paid"in e&&"Owed"in e}var w=function(){function e(){Object(c.a)(this,e),this.StartNo=void 0,this.Epunch=void 0,this.EpunchRented=void 0,this.FirstName=void 0,this.LastName=void 0,this.Club=void 0,this.Course=void 0,this.ClassId=void 0,this.NonCompetitive=void 0,this.Sex=void 0,this.Phone=void 0,this.EmergencyPhone=void 0,this.CarLicense=void 0,this.Newcomer=void 0,this.Group=void 0,this.Paid=void 0,this.Owed=void 0}return Object(l.a)(e,[{key:"fromWiolEntryCsv",value:function(e){return this.StartNo=e["Bib #"],this.Epunch=e["SI Card"],this.EpunchRented="X"===e.Rent,this.FirstName=e["First Name"],this.LastName=e["Last Name"],this.Club=e.School,this.Course="",this.ClassId=e.Course,this.NonCompetitive="X"===e.NC,this.Sex=e.Gen,this.Phone="",this.EmergencyPhone="",this.CarLicense="",this.Newcomer="unknown",this.Group=1,this.Paid="unknown",this.Owed=0,this}},{key:"fromCascadeRegistrationCsv",value:function(e){return this.StartNo=null,this.Epunch=e.EPunch,this.EpunchRented=""===e.EPunch,this.FirstName=e.FirstName,this.LastName=e.LastName,this.Club=e.Club,this.Course="",this.ClassId=e.Class,this.NonCompetitive=!1,this.Sex=e.Sex,this.Phone=e.Phone,this.EmergencyPhone=e.EmergencyPhone,this.CarLicense=e.CarLicense,this.Newcomer=e.Newcomer,this.Group=e.Group?e.Group:1,this.Paid=e.Paid,this.Owed=e.Owed?e.Owed:0,this}}]),e}();var F=n.p+"static/media/LostTimeWordmark.2977d17a.svg",P=n.p+"static/media/mapmontageblur.c977ea5b.jpg",L=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(O.jsx)(C.a,{children:Object(O.jsx)("nav",{className:"nav-bar",style:{backgroundImage:"url(".concat(P,")"),backgroundRepeat:"repeat-xy",marginBottom:"20px"},children:Object(O.jsx)(y.a,{xs:{span:10,offset:1},children:Object(O.jsx)("div",{className:"nav-img",style:{paddingTop:"5px",paddingBottom:"5px"},children:Object(O.jsx)("a",{href:"/",children:Object(O.jsx)("img",{src:F,alt:"Lost Time Orienteering",style:{height:"60px",margin:"0px"}})})})})})})}}]),n}(i.a.Component),R=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{style:{},children:this.props.title}),Object(O.jsx)("div",{style:{width:"100%",height:"2px",backgroundColor:"magenta",marginTop:"10px",marginBottom:"10px"}})]})}}]),n}(i.a.Component),I=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{children:this.props.value.FirstName}),Object(O.jsx)("td",{children:this.props.value.LastName}),Object(O.jsx)("td",{children:this.props.value.Epunch}),Object(O.jsx)("td",{style:{textAlign:"center"},children:this.props.value.EpunchRented?"yes":"no"}),Object(O.jsx)("td",{children:this.props.value.ClassId}),Object(O.jsx)("td",{children:this.props.value.StartNo})]})}}]),n}(i.a.Component),T=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return this.props.failed>0?Object(O.jsxs)("li",{children:[this.props.name," (Found: ",this.props.success,", Failed: ",this.props.failed,")"]}):Object(O.jsxs)("li",{children:[this.props.name," (Found: ",this.props.success,")"]})}}]),n}(i.a.Component),D=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(O.jsxs)(y.a,{xs:4,sm:3,md:4,lg:3,children:[Object(O.jsx)("b",{children:this.props.classname}),": ",this.props.regcount]})}}]),n}(i.a.Component),B=function(e){Object(d.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(c.a)(this,n),(s=t.call(this,e)).state={filesprocessed:[],entries:[],nextstartno:1e3},s.handleUnparse=s.handleUnparse.bind(Object(h.a)(s)),s.updateEntries=s.updateEntries.bind(Object(h.a)(s)),s.handleClearEntries=s.handleClearEntries.bind(Object(h.a)(s)),s.nowtimestring=s.nowtimestring.bind(Object(h.a)(s)),s}return Object(l.a)(n,[{key:"handleClearEntries",value:function(){this.setState({entries:[],filesprocessed:[]})}},{key:"handleUnparse",value:function(){if(0!==this.state.entries.length){var e=function(e){var t,n=[],s=Math.max.apply(Math,Object(o.a)(e.map((function(e){return e.StartNo?e.StartNo:0}))));t=s>1001?s+1:1001;var i,r=Object(x.a)(e);try{for(r.s();!(i=r.n()).done;){var a=i.value;a.StartNo||(a.StartNo=t,t++),n.push(v(a))}}catch(c){r.e(c)}finally{r.f()}return n}(this.state.entries);this.setState({entries:this.state.entries});var t={quotes:!1,delimiter:";",header:!0,skipEmptyLines:"greedy",columns:g},n=p.a.unparse(e,t),s=this.nowtimestring(),i=document.createElement("a");i.href="data:text/csv;charset=utf-8,"+encodeURI(n),i.target="_blank",i.download="EntriesForOe-".concat(s,".csv"),i.click()}else console.log("No entries")}},{key:"nowtimestring",value:function(){var e=new Date,t=e.getFullYear().toString(),n=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0"),i=e.getHours().toString().padStart(2,"0"),r=e.getMinutes().toString().padStart(2,"0");return t.concat(n,s,"T",i,r)}},{key:"updateEntries",value:function(e){var t=this;p.a.parse(e,{header:!0,transform:function(e,t){return e.replace(/\0/g,"").trim()},complete:function(e,n){var s=function(e,t){var n,s=[],i=0,r=0,a=Object(x.a)(e);try{for(a.s();!(n=a.n()).done;){var c=n.value;if(k(c)){var l=(new w).fromWiolEntryCsv(c);s.push(l)}else if(E(c)){var h=(new w).fromCascadeRegistrationCsv(c);s.push(h)}else Object.keys(c).length<=1?(console.log(Object.keys(c)),console.log("empty row"),i+=1):(console.log(Object.keys(c)),console.log("failed to parse row"),r+=1)}}catch(d){a.e(d)}finally{a.f()}return{data:s,meta:{success:s.length,failed:r,empty:i,maxstartno:Math.max.apply(Math,Object(o.a)(s.map((function(e){return e.StartNo?e.StartNo:1001}))))}}}(e.data,t.state.nextstartno),i=t.state.entries.concat(s.data);t.setState({entries:i,nextstartno:s.meta.maxstartno});var r={name:n.name,success:s.meta.success,failed:s.meta.failed,empty:s.meta.empty};t.setState({filesprocessed:[].concat(Object(o.a)(t.state.filesprocessed),[r])})}})}},{key:"render",value:function(){var e=this.state.entries.length>0?this.state.entries.map((function(e){return Object(O.jsx)(I,{value:e})})):Object(O.jsx)("tr",{children:Object(O.jsx)("td",{colSpan:6,style:{textAlign:"center"},children:"No Registrations to Show"})}),t=this.state.filesprocessed.map((function(e){return Object(O.jsx)(T,{name:e.name,success:e.success,failed:e.failed,empty:e.empty})})),n=this.state.entries.reduce((function(e,t){return e[t.ClassId]?e[t.ClassId]++:e[t.ClassId]=1,e}),{}),s=Object.entries(n).sort((function(e,t){return e[0].toLocaleLowerCase().localeCompare(t[0].toLocaleLowerCase())})).map((function(e){return Object(O.jsx)(D,{classname:e[0],regcount:e[1]})}));return Object(O.jsxs)("div",{children:[Object(O.jsx)(R,{title:"Pre-Process Registration Files"}),Object(O.jsx)("p",{children:"Save event registration information in .csv format. Upload multiple files to combine registration information from multiple sources. (Todo: click to expand for supported csv formats)"}),Object(O.jsx)("p",{children:"This tool creates outputs ready for import into SportSoftware (OE). (Future: and pdf files to use at check-in)"}),Object(O.jsx)("h4",{children:"Files"}),Object(O.jsx)("p",{children:Object(O.jsx)(f,{parser:this.updateEntries})}),Object(O.jsxs)(C.a,{children:[Object(O.jsxs)(y.a,{xs:12,md:6,children:[Object(O.jsxs)(C.a,{children:[Object(O.jsxs)("p",{children:["Files Uploaded: ",this.state.filesprocessed.length]}),Object(O.jsx)("p",{children:Object(O.jsx)("ul",{children:t})}),Object(O.jsxs)("p",{children:["Registrations by Class (Total: ",this.state.entries.length,")"]}),Object(O.jsx)("p",{children:Object(O.jsx)(C.a,{children:s})})]}),Object(O.jsx)(C.a,{children:Object(O.jsxs)("p",{children:[Object(O.jsx)(S.a,{variant:"primary",onClick:this.handleUnparse,disabled:!(this.state.entries.length>0),children:"Download OE File"}),"\xa0",Object(O.jsx)(S.a,{variant:"outline-secondary",onClick:this.handleClearEntries,children:"Clear Registrations"})]})})]}),Object(O.jsx)(y.a,{xs:6,md:6,children:Object(O.jsxs)("table",{style:{textAlign:"left"},children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"First"}),Object(O.jsx)("th",{children:"Last"}),Object(O.jsx)("th",{children:"Chip"}),Object(O.jsx)("th",{children:"Rented?"}),Object(O.jsx)("th",{children:"Class"}),Object(O.jsx)("th",{children:"Start #"})]})}),Object(O.jsx)("tbody",{children:e})]})})]})]})}}]),n}(i.a.Component);var M=function(){return Object(O.jsx)("div",{className:"App",children:Object(O.jsxs)(N.a,{fluid:!0,style:{backgroundColor:"#F7F7F7"},children:[Object(O.jsx)(L,{}),Object(O.jsx)(C.a,{children:Object(O.jsx)(y.a,{xs:{span:10,offset:1},children:Object(O.jsx)(B,{})})})]})})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,s=t.getFID,i=t.getFCP,r=t.getLCP,a=t.getTTFB;n(e),s(e),i(e),r(e),a(e)}))};n(32);a.a.render(Object(O.jsx)(i.a.StrictMode,{children:Object(O.jsx)(M,{})}),document.getElementById("root")),G()}},[[33,1,2]]]);
//# sourceMappingURL=main.1dc059cd.chunk.js.map